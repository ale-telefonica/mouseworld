# Copyright 2019 ETSI OSM
#
# All Rights Reserved.
#
#    Licensed under the Apache License, Version 2.0 (the "License"); you may
#    not use this file except in compliance with the License. You may obtain
#    a copy of the License at
#
#         http://www.apache.org/licenses/LICENSE-2.0
#
#    Unless required by applicable law or agreed to in writing, software
#    distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
#    License for the specific language governing permissions and limitations
#    under the License.

vnfd:
  id: {{ name }}_vnfd
  product-name: {{ name }}_vnfd
  description: Generated by OSM package generator
  provider: OSM
  version: '1.0'
  mgmt-cp: vnf-cp0-ext
  virtual-storage-desc:
  - id: {{ name }}_vnfd-VM-storage
    size-of-storage: {{ storage }}
    {%- if detailed is sameas true %}
    #disk-io-quota:
    #  limit: <update, optional>
    #  reserve: <update, optional>
    #  shares: <update, optional>
    {%- endif %}
  virtual-compute-desc:
  - id: {{ name }}_vnfd-VM-compute
    virtual-cpu:
      num-virtual-cpu: {{ vcpu }}
      {%- if detailed is sameas true %}
      #pinning:
      #  # Choice cpu-pinning / cpu-quota
      #  policy: <update, optional> [dynamic, static]
      #  thread-policy: <update, optional> [AVOID, SEPARATED, ISOLATE, PREFER]
      #  cpu-quota:
      #    limit: <update, optional>
      #    reserve: <update, optional>
      #    shares: <update, optional>
      {%- endif %}
    virtual-memory:
      size: {{ memory }}
      {%- if detailed is sameas true %}
      #guest-epa:
      #  mempage-size: <update, optional>
      #  mem-quota:
      #    limit: <update, optional>
      #    reserve: <update, optional>
      #    shares: <update, optional>
      {%- endif %}
  sw-image-desc:
  - id: "{{ image }}"
    name: "{{ image }}"
    image: "{{ image }}"
  {%- if detailed is sameas true %}
  #-  id: <update>
  #   name: <update, optional>
  #   image: <update, optional>
  #   vim-type: <update>
  {%- endif %}
  df:
  - id: default-df
    instantiation-level:
    - id: default-instantiation-level
      vdu-level:
      - vdu-id: {{ name }}_vnfd-VM
        number-of-instances: 1
    vdu-profile:
    - id: {{ name }}_vnfd-VM
      min-number-of-instances: 1
      max-number-of-instances: 1
    {%- if detailed is sameas true %}
    #lcm-operations-configuration:
    #  operate-vnf-op-config:
    #    day1-2:
    #    - id: {{ name }}_vnfd-VM
    #      # Configure the VNF or VDU through Juju.
    #      juju:
    #        charm: <update, optional>
    #        proxy: <update, optional>
    #        vca-relationships:
    #          relation:
    #          - requires: <update>
    #            provides: <update>
    #      config-primitive:
    #      - name: <update>
    #        parameter:
    #        - name: <update>
    #          data-type: <update, optional>
    #          mandatory: <update, optional>
    #          default-value: <update, optional>
    #          parameter-pool: <update, optional>
    #          read-only: <update, optional>
    #          hidden: <update, optional>
    #      initial-config-primitive:
    #      - seq: <update>
    #        name: <update, optional>
    #        parameter:
    #        - name: <update>
    #          data-type: <update, optional>
    #          value: <update, optional>
    #      terminate-config-primitive:
    #      - seq: <update>
    #        name: <update, optional>
    #        parameter:
    #        - name: <update>
    #          data-type: <update, optional>
    #          value: <update, optional>
    #      metrics:
    #      - name: <update>
    #      config-access:
    #        ssh-access:
    #          required: <update, optional>
    #          default-user: <update, optional>
    #scaling-aspect:
    #- id: <update>
    #  name: <update>
    #  max-scale-level: <update, optional>
    #  scaling-policy:
    #  - name: <update>
    #    scaling-type: <update, optional>
    #    enabled: <update, optional>
    #    scale-in-operator-type: <update, optional>
    #    scale-out-operator-type: <update, optional>
    #    threshold-time: <update, optional>
    #    cooldown-time: <update, optional>
    #    scaling-criteria: <update, optional>
    #    - name: <update>
    #      scale-in-threshold: <update, optional>
    #      scale-in-relational-operation: <update, optional>
    #      scale-out-threshold: <update, optional>
    #      scale-out-relational-operation: <update, optional>
    #      vnf-monitoring-param-ref: <update, optional>
    #  scaling-config-action:
    #  - trigger: <update>
    #    vnf-config-primitive-name-ref: <update, optional>
    #  aspect-delta-details:
    #    id: <update>-delta
    #    vdu-delta:
    #    - number-of-instances: 1
    #      id: {{ name }}_vnfd-VM
    {%- endif %}
    {%- if detailed is sameas true %}
    ## Placement groups at VNF Level
    #placement-groups:
    #- name: <update>
    #  requirement: <update, optional>
    #  strategy: <update, optional> # COLOCATION, ISOLATION
    #  member-vdus:
    #  - member-vdu-ref: <update>
    {%- endif %}
    # At least one VDU need to be specified
    # Additional VDUs can be created by copying the
    # VDU descriptor below
  vdu:
  - id: {{ name }}_vnfd-VM
    name: {{ name }}_vnfd-VM
    description: {{ name }}_vnfd-VM
    sw-image-desc: "{{ image }}"
    {%- if detailed is sameas true %}
    ## Choice cloud-init / cloud-init-file
    #cloud-init: <update, optional>
    #cloud-init-file: <update, optional>
    #supplemental-boot-data:
    #    boot-data-drive: <update, optional>
    #alarm:
    #- alarm-id: <update>
    #  vnf-monitoring-param-ref: <update, optional>
    #  operation: <update, optional>
    #  value: <update, optional>
    #  actions:
    #    ok:
    #    - url: <update>
    #    insufficient-data:
    #    - url: <update>
    #    alarm:
    #    - url: <update>
    #pdu-type: <update, optional>
    #alternative-sw-image-desc:
    #- id: <update>
    #  name: <update, optional>
    #  image: <update, optional>
    #  vim-type: <update>
    {%- endif %}
    virtual-storage-desc:
    - {{ name }}_vnfd-VM-storage
    virtual-compute-desc: {{ name }}_vnfd-VM-compute
    {%- if detailed is sameas true %}
    #monitoring-parameter:
    #- id: <update>
    #  name: <update, optional>
    #  performance-metric: <update>
    {%- endif %}
    int-cpd:
    - id: eth0-int
      virtual-network-interface-requirement:
      - name: eth0
        virtual-interface:
          type: PARAVIRT
          {%- if detailed is sameas true %}
          #vpci: <update, optional>
          #bandwidth: <update, optional>
          {%- endif %}
  ext-cpd:
  - id: vnf-cp0-ext
    int-cpd:
      vdu-id: {{ name }}_vnfd-VM
      cpd: eth0-int
      {%- if detailed is sameas true %}
      #port-security-enabled: <update, optional>
      #port-security-disable-strategy: <update, optional>
      {%- endif %}